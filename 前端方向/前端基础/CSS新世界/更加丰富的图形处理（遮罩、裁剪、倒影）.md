## 使用的 CSS 遮罩 （mask）

遮罩基本概念：所谓遮罩效果，就是只会显示遮罩图像非透明区域的内容；假设 A 图作为遮罩图片，B 图作为渲染图片，则可以理解为 A 图的非透明区域作为画板区域，B 图则渲染在画板上，透明区域是没有画板的，也就不渲染；因此，遮罩图片必须是支持 Alpha 通道的图片格式，典型的是 png，如果使用 jpg 这类不支持 Alpha 通道的图片，则不会有任何效果；

_Tips:可以通过设置 mask-type 来修改遮罩使用的通道类型，默认是 Alpha 通道，可以修改为亮度_

遮罩图片支持使用 SVG，如果 SVG 没有内在尺寸，则会按照当前匹配的元素等比例缩放；比较实用的是用 CSS 渐变作为遮罩图像，因为渐变是可变且灵活的，可以很方便的创建动态遮罩

基础案例：

```css
.mask-image {
  /* 缩写形式，缩写的mask-repeat、mask-size */
  mask: no-repeat center / contain;
  /* 等价于 */
  mask-repeat: no-repeat center;
  mask-size: contain;
  /* 设置遮罩图片 */
  mask-image: url(bird.png);
}
```

### 相关属性

- mask-image：遮罩图片，位图默认使用 alpha 通道作为遮罩计算参考，不透明的显示，透明的不显示，可以通过 mask-mode 修改为 luminance（通过亮度计算）
- mask-repeat：与 background-repeat 作用基本一致，控制遮罩图片的重复平铺行为，遮罩图片有可能多个，因此这个值也支持多组
- mask-position：与 background-positioning 作用基本一致，控制遮罩图片的应用位置，支持多组
- mask-clip：与 background-clip 基本一致，控制遮罩的应用范围，支持多组
- mask-size：与 background-size 基本一致，控制遮罩图片的尺寸与缩放行为，支持多组
- mask-mode：默认值是 match-source，可以指定遮罩作用的通道类型（alpha 或者 luminance）作用是根据资源的类型自动采用合适的遮罩模式（兼容性不好），遮罩支持多图片，因此这个属性也支持多个（Chrome 并不支持）
- mask-type：与 mosk-mode 作用一致，但是仅作用于 SVG 元素上
- mask-composite：指定多个 mask 遮罩图片的叠加行为
- mask 属性简写
- \-webkit-mask-box-image：使用图像来裁剪元素 BOX，类似 border-image 的理解，效果有点儿惊艳
- mask-border：\-webkit-mask-box-image 属性的 CSS 官方标准，目前浏览器还不支持

### 关于 mask-composite

mask-composite 属性表示同时使用多张图片进行遮罩时的合成方式

**前置说明：多个遮罩图像，代码中顺序越往后的图像层级越低，在进行遮罩合并时，层级低的作为 destination，层级高的作为 source**

它支持如下属性值:

- add：相加模式，多个遮罩累加效果（默认）
- subtract：减除模式，解释为 destination 减去 source 后剩下的范围作为合并后的计算结果（source out）
- intersect：表现为“source in”，解释为 destination 包含在 source 中的部分作为合并后的结果
- exclude/xor(chrome、webkit 系浏览器中使用)：排除 destination 与 source 相交的部分后剩下的部分作为合并结构（常用语镂空效果实现）

> Tips1:关于-webkit-mask-composite:xor，这段 CSS 声明是专门给 Chrome、Safari 等浏览器使用，因此在使用 exclude 属性值时，需要额外为 Chrome、webkit 系浏览器编写兼容代码

> Tips2：Chrome 的属性值支持与 CSS 规范描述并不一致，需要注意

### 使用遮罩优化 png 图片大小（极限性能场景可以考虑）

png 支持透明，但是如果图像色彩、光影效果丰富，那么尺寸会比较大，转成 jpg 格式又会失去透明度支持，此时在性能要求非常高的场景（比如移动端，嵌入式端），可以采用如下方案进行优化（如果图片包含半透明效果，创建遮罩剪影图可能会需要点儿技术），压缩率非常高：

1. 将原 PNG 图转为 jpg 图像，降低原始图片大小
2. 使用原始图像，创建原始图像非透明区域的纯色 PNG 剪影（其实就是 PNG 图像的 Alpha 通道）
3. 将剪影图当做遮罩应用在 JPG 图像上就可以实现原始 PNG 图像的效果了

## clip-path