# Windows 下交叉编译 Linux 可执行文件

Windows 下编译 Linux 可执行文件，需要用到 Linux gcc 工具链，手动在 Windows 下安装整个工具链非常麻烦...好在目前 Windows 下有 WSL 子系统了，我们可以借助 WSL Linux 子系统搭配 Docker 来方便的实现环境准备

## Corss

按照下面的步骤即可方便的配置好 Cross 交叉编译环境：

1. 安装 WSL Linux 子系统：控制面板 -> 程序 -> 启用或关闭 Windows 功能 -> 勾选适用于 Linux 的 Windows 子系统 -> 确定，然后重启
2. 安装 [Docker Desktop](https://www.docker.com/products/docker-desktop/)，并重启
3. 安装 [cross](https://github.com/cross-rs/cross)

安装完成后，就可以在 Windows 下编译 Linux 可执行文件了：

```shell
# 静态链接
cross build --target x86_64-unknown-linux-musl --release
# 动态链接
cross build --target x86_64-unknown-linux-gnu --release
```

## cargo-zigbuild

另外一个不使用 WSL 的交叉编译工具链，如果本地因为系统原因，无法使用 WSL，那么就用 [cargo-zigbuild](https://github.com/rust-cross/cargo-zigbuild)

1. 安装：`cargo install --locked cargo-zigbuild`
2. 安装目标环境：`rustup target add x86_64-unknown-linux-musl`
3. 编译：`cargo zigbuild --target x86_64-unknown-linux-musl`

Tips: 感觉首次编译要比 corss 慢得多，但是产物体积要小一些。
